# yaml-language-server: $schema=https://json.schemastore.org/prometheus.json

# A scrape configuration for running Prometheus on a Docker Swarm cluster.
# This uses separate scrape configs for cluster components (i.e. nodes, services, tasks).
# 
# Keep at most 50 sets of details of targets dropped by relabeling.
# This information is used to display in the UI for troubleshooting.
global:
  scrape_interval: '10s'
  scrape_timeout: '5s'
  evaluation_interval: '1m'
  # keep_dropped_targets: 50

# ====================================================
# Scrape configuration
# ====================================================

scrape_configs:
  - job_name: 'docker'
    static_configs:
      - targets: ['host.docker.internal:9323']

  - job_name: 'cadvisor'
    static_configs:
      - targets: ['replica-{{.Task.Slot}}.cadvisor.internal:8080']

  - job_name: 'node_exporter'
    static_configs:
      - targets: ['replica-{{.Task.Slot}}.node-exporter.internal:9100']

  - job_name: 'prometheus'
    static_configs:
      - targets: ['127.0.0.1:9090']
